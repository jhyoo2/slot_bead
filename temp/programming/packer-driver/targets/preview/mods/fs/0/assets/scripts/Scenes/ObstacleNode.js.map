{"version":3,"sources":["file:///Users/david/Desktop/David/cocos/slot_bead/assets/scripts/Scenes/ObstacleNode.ts"],"names":["_decorator","Node","Vec3","Collider2D","Contact2DType","Label","tween","BaseScene","BeadNode","PinballScene","ccclass","property","ObstacleNode","String","onLoad","collider","getComponent","on","BEGIN_CONTACT","onBeginContact","selfCollider","otherCollider","contact","node","pinballScene","addGold","Number","myTag","myNode","myLabel","addComponent","string","addChild","setPosition","by","position","delay","call","removeFromParent","destroy","start"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACEA,MAAAA,U,OAAAA,U;AAGAC,MAAAA,I,OAAAA,I;AAGAC,MAAAA,I,OAAAA,I;AAIAC,MAAAA,U,OAAAA,U;AACAC,MAAAA,a,OAAAA,a;AAEAC,MAAAA,K,OAAAA,K;AACAC,MAAAA,K,OAAAA,K;;AAIKC,MAAAA,S;;AAGEC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;AANDC,MAAAA,O,GAAsBV,U,CAAtBU,O;AAASC,MAAAA,Q,GAAaX,U,CAAbW,Q;;8BASJC,Y,WADZF,OAAO,CAAC,cAAD,C,UAELC,QAAQ,CAACE,MAAD,C,UAGRF,QAAQ;AAAA;AAAA,uC;;;;;;;;;;;;;;;;gEAGH,C;;mEACG,C;;;;;;;eAEHG,M;gFAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,mCAAMA,MAAN;;AAEIC,oBAAAA,QAHN,GAGiB,KAAKC,YAAL,CAAkBb,UAAlB,CAHjB;;AAIE,wBAAIY,QAAJ,EAAc;AACZA,sBAAAA,QAAQ,CAACE,EAAT,CAAYb,aAAa,CAACc,aAA1B,EAAyC,KAAKC,cAA9C,EAA8D,IAA9D,EADY,CAEZ;AACA;AACA;AACD;;AATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,W;;;;;;;;;eAWAA,c,GAAA,wBACEC,YADF,EAEEC,aAFF,EAGEC,OAHF,EAIE;AACA,cAAID,aAAa,CAACE,IAAd,CAAmBP,YAAnB;AAAA;AAAA,mCAAJ,EAA+C;AAC7C,gBAAI,KAAKQ,YAAT,EAAuB;AACrB,mBAAKA,YAAL,CAAkBC,OAAlB,CAA0BC,MAAM,CAAC,KAAKC,KAAN,CAAhC;AACD;;AAED,gBAAMC,MAAM,GAAG,IAAI3B,IAAJ,EAAf;AACA,gBAAM4B,OAAO,GAAGD,MAAM,CAACE,YAAP,CAAoBzB,KAApB,CAAhB;AACAwB,YAAAA,OAAO,CAACE,MAAR,GAAiB,YAAYL,MAAM,CAAC,KAAKC,KAAN,CAAnC;AACA,iBAAKJ,IAAL,CAAUS,QAAV,CAAmBJ,MAAnB;AACAA,YAAAA,MAAM,CAACK,WAAP,CAAmB,IAAI/B,IAAJ,CAAS,CAAT,EAAY,GAAZ,EAAiB,CAAjB,CAAnB;AACAI,YAAAA,KAAK,CAACsB,MAAD,CAAL,CACGM,EADH,CACM,GADN,EACW;AAAEC,cAAAA,QAAQ,EAAE,IAAIjC,IAAJ,CAAS,CAAT,EAAY,EAAZ,EAAgB,CAAhB;AAAZ,aADX,EAEGkC,KAFH,CAES,GAFT,EAGGC,IAHH,CAGQ,YAAM;AACVT,cAAAA,MAAM,CAACU,gBAAP;AACAV,cAAAA,MAAM,CAACW,OAAP;AACD,aANH,EAOGC,KAPH;AAQD;AACF,S;;;;;;;;;;iBA3CO,E;;;;;;;iBAGqB,I","sourcesContent":["import {\r\n  _decorator,\r\n  size,\r\n  director,\r\n  Node,\r\n  PhysicsSystem2D,\r\n  Vec2,\r\n  Vec3,\r\n  RigidBody2D,\r\n  Prefab,\r\n  instantiate,\r\n  Collider2D,\r\n  Contact2DType,\r\n  IPhysics2DContact,\r\n  Label,\r\n  tween,\r\n} from \"cc\";\r\nconst { ccclass, property } = _decorator;\r\n\r\nimport BaseScene from \"../BaseObject/BaseScene\";\r\nimport AssetManager from \"../DataManager/AssetManager\";\r\nimport BaseRoom from \"../Prefabs/Room/BaseRoom\";\r\nimport { BeadNode } from \"./BeadNode\";\r\nimport { PinballScene } from \"./PinballScene\";\r\n\r\n@ccclass(\"ObstacleNode\")\r\nexport class ObstacleNode extends BaseScene {\r\n  @property(String)\r\n  myTag = \"\";\r\n\r\n  @property(PinballScene)\r\n  pinballScene: PinballScene = null;\r\n\r\n  row = 0;\r\n  column = 0;\r\n\r\n  async onLoad() {\r\n    super.onLoad();\r\n\r\n    let collider = this.getComponent(Collider2D);\r\n    if (collider) {\r\n      collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n      // collider.on(Contact2DType.END_CONTACT, this.onEndContact, this);\r\n      // collider.on(Contact2DType.PRE_SOLVE, this.onPreSolve, this);\r\n      // collider.on(Contact2DType.POST_SOLVE, this.onPostSolve, this);\r\n    }\r\n  }\r\n  onBeginContact(\r\n    selfCollider: Collider2D,\r\n    otherCollider: Collider2D,\r\n    contact: IPhysics2DContact | null\r\n  ) {\r\n    if (otherCollider.node.getComponent(BeadNode)) {\r\n      if (this.pinballScene) {\r\n        this.pinballScene.addGold(Number(this.myTag));\r\n      }\r\n\r\n      const myNode = new Node();\r\n      const myLabel = myNode.addComponent(Label);\r\n      myLabel.string = \"GOLD + \" + Number(this.myTag);\r\n      this.node.addChild(myNode);\r\n      myNode.setPosition(new Vec3(0, 100, 0));\r\n      tween(myNode)\r\n        .by(0.2, { position: new Vec3(0, 70, 0) })\r\n        .delay(0.3)\r\n        .call(() => {\r\n          myNode.removeFromParent();\r\n          myNode.destroy();\r\n        })\r\n        .start();\r\n    }\r\n  }\r\n}\r\n"]}